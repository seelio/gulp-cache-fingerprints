// Generated by CoffeeScript 1.8.0
(function() {
  var Cache, fs, path;

  fs = require("fs");

  path = require("path");

  Cache = (function() {
    function Cache(options) {
      this.options = options;
      this.datastore = {};
    }

    Cache.prototype.set = function(relpath, value) {
      var key;
      key = this._key(relpath);
      return this.datastore[key] = value;
    };

    Cache.prototype.keys = function() {
      return Object.keys(this.datastore);
    };

    Cache.prototype.write = function(done) {
      return fs.writeFile(this.cachePath(), JSON.stringify(this.datastore), done);
    };

    Cache.prototype.cachePath = function() {
      return path.resolve(this.options.root, this.options.output);
    };

    Cache.prototype._key = function(relpath) {
      return relpath.replace(new RegExp("^" + this.options.base + "/*"), "");
    };

    return Cache;

  })();

  module.exports = Cache;

}).call(this);
